<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–æ–µ–≤–∞—è –ë–∞–∑–∞ - Google Sheets</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #ffffff;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #c1a270 0%, #d4b886 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(193, 162, 112, 0.3);
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 500;
            text-align: center;
        }

        .nav {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1rem;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 0.5rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: white;
            color: #c1a270;
        }

        /* Main Content */
        .main {
            padding: 2rem 0;
            min-height: calc(100vh - 120px);
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 2rem;
            font-size: 1.2rem;
            color: #c1a270;
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: #dc3545;
            background: #f8d7da;
            border-radius: 10px;
            margin: 1rem 0;
        }

        .success {
            text-align: center;
            padding: 1rem;
            color: #155724;
            background: #d4edda;
            border-radius: 10px;
            margin: 1rem 0;
        }

        /* Participants Grid */
        .participants-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .participant-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .participant-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        .participant-header {
            background: linear-gradient(135deg, #c1a270 0%, #d4b886 100%);
            padding: 1.5rem;
            text-align: center;
            color: white;
            position: relative;
        }

        .score-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.9);
            color: #c1a270;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .participant-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            border: 3px solid white;
            object-fit: cover;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
        }

        .participant-name {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .participant-role {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .participant-info {
            padding: 1.5rem;
        }

        .participant-bio {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .participant-weapons {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .weapon-info {
            background: #f8f9fa;
            padding: 0.5rem;
            border-radius: 5px;
            font-size: 0.85rem;
            border-left: 3px solid #c1a270;
        }

        .weapon-label {
            font-weight: 600;
            color: #c1a270;
        }

        /* Profile Styles */
        .profile {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .profile-header {
            background: linear-gradient(135deg, #c1a270 0%, #d4b886 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            position: relative;
        }

        .profile-score {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            color: #c1a270;
            padding: 1rem 1.5rem;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1.2rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .profile-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            border: 5px solid white;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            object-fit: cover;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
        }

        .profile-name {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .profile-bio {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .profile-content {
            padding: 2rem;
        }

        .profile-section {
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #c1a270;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .weapon-card, .equipment-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .weapon-card:hover, .equipment-card:hover {
            border-color: #c1a270;
            transform: translateY(-2px);
        }

        .weapon-title {
            font-weight: 600;
            color: #c1a270;
            margin-bottom: 0.5rem;
        }

        .equipment-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
        }

        .equipment-item {
            background: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            border-left: 3px solid #c1a270;
            font-size: 0.9rem;
        }

        .back-btn {
            background: #c1a270;
            color: white;
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: #a68a5b;
            transform: translateY(-2px);
        }

        .hidden {
            display: none;
        }

        .refresh-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            margin-bottom: 1rem;
            margin-left: 1rem;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        /* Leaderboard */
        .sort-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .sort-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .sort-btn:hover {
            background: #5a6268;
        }

        .sort-btn.active {
            background: #c1a270;
        }

        .status-info {
            text-align: center;
            margin: 1rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #dee2e6;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav {
                flex-direction: column;
                align-items: center;
                gap: 1rem;
            }

            .profile-avatar {
                width: 120px;
                height: 120px;
            }

            .profile-name {
                font-size: 1.5rem;
            }

            .container {
                padding: 0 15px;
            }

            .score-badge, .profile-score {
                position: static;
                display: inline-block;
                margin-top: 1rem;
            }

            .sort-controls {
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <h1>–ë–æ–µ–≤–∞—è –ë–∞–∑–∞</h1>
            <nav class="nav">
                <button class="nav-btn active" onclick="showParticipants()">–£—á–∞—Å—Ç–Ω–∏–∫–∏</button>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <!-- Participants Section -->
            <div id="participantsSection">
                <button class="refresh-btn" onclick="loadParticipants()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                
                <div class="sort-controls">
                    <button class="sort-btn active" onclick="sortBy('default')">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
                    <button class="sort-btn" onclick="sortBy('score')">–ü–æ –±–∞–ª–ª–∞–º ‚¨á</button>
                    <button class="sort-btn" onclick="sortBy('name')">–ü–æ –∏–º–µ–Ω–∏</button>
                </div>
                
                <div id="loadingMessage" class="loading hidden">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Google –¢–∞–±–ª–∏—Ü...</div>
                <div id="errorMessage" class="error hidden"></div>
                <div id="successMessage" class="success hidden"></div>
                <div id="statusInfo" class="status-info">
                    <strong>‚úÖ –¢–∞–±–ª–∏—Ü–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞!</strong><br>
                    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–∞—è Google –¢–∞–±–ª–∏—Ü–∞.<br>
                    –ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ" –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
                </div>
                <div class="participants-grid" id="participantsContainer">
                    <!-- Participants will be dynamically loaded here -->
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profileSection" class="hidden">
                <button class="back-btn" onclick="showParticipants()">‚Üê –ù–∞–∑–∞–¥ –∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º</button>
                <div class="profile" id="profileContainer">
                    <!-- Profile will be dynamically loaded here -->
                </div>
            </div>
        </div>
    </main>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Google Sheets
        const GOOGLE_SHEETS_CONFIG = {
            // –ò–∑–≤–ª–µ–∫–∞–µ–º ID –∏–∑ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–≥–æ URL
            publishedId: '2PACX-1vSyv3bAifxY2clEjSnLpiSFm3RwRULCbbuk19HGQYBiRmE-Llq81jmk5kalFY8v07Vt4DODTxltvVZa',
            gid: '0' // ID –ª–∏—Å—Ç–∞ (0 –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Å—Ç–∞)
        };

        let profiles = {};
        let currentSort = 'default';

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
        function getImageUrl(avatarUrl) {
            if (!avatarUrl || avatarUrl.trim() === '') {
                return getDefaultAvatar('User');
            }
            
            // –ï—Å–ª–∏ —ç—Ç–æ —É–∂–µ data URL –∏–ª–∏ –ø–æ–ª–Ω—ã–π URL, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å
            if (avatarUrl.startsWith('data:') || avatarUrl.startsWith('http')) {
                return avatarUrl;
            }
            
            // –ï—Å–ª–∏ —ç—Ç–æ Google Drive —Å—Å—ã–ª–∫–∞, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É
            if (avatarUrl.includes('drive.google.com')) {
                return convertGoogleDriveUrl(avatarUrl);
            }
            
            // –ï—Å–ª–∏ —ç—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å
            return avatarUrl;
        }

        function convertGoogleDriveUrl(url) {
            // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º Google Drive —Å—Å—ã–ª–∫–∏ –≤ –ø—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const fileIdMatch = url.match(/\/d\/([a-zA-Z0-9-_]+)/);
            if (fileIdMatch) {
                return `https://drive.google.com/uc?export=view&id=${fileIdMatch[1]}`;
            }
            return url;
        }

        function getDefaultAvatar(name, size = 80) {
            // –°–æ–∑–¥–∞–µ–º –∞–≤–∞—Ç–∞—Ä —Å –∏–Ω–∏—Ü–∏–∞–ª–∞–º–∏
            const initials = name ? name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2) : '?';
            const colors = [
                '#c1a270', '#e74c3c', '#3498db', '#2ecc71', '#f39c12', 
                '#9b59b6', '#1abc9c', '#e67e22', '#34495e', '#e91e63'
            ];
            const colorIndex = name ? name.length % colors.length : 0;
            const bgColor = colors[colorIndex];
            
            const svg = `
                <svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="${size}" height="${size}" rx="${size/2}" fill="${bgColor}"/>
                    <text x="${size/2}" y="${size/2 + 8}" text-anchor="middle" fill="white" font-size="${size/3}" font-family="Arial, sans-serif" font-weight="bold">${initials}</text>
                </svg>
            `;
            
            return 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svg)));
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        function preloadImage(url) {
            return new Promise((resolve, reject) => {
                if (!url || url.startsWith('data:')) {
                    resolve(url);
                    return;
                }
                
                const img = new Image();
                img.crossOrigin = 'anonymous';
                img.onload = () => resolve(url);
                img.onerror = () => reject(new Error('Failed to load image'));
                img.src = url;
                
                // Timeout –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
                setTimeout(() => reject(new Error('Image load timeout')), 5000);
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Google Sheets
        async function loadDataFromGoogleSheets() {
            const loadingEl = document.getElementById('loadingMessage');
            const errorEl = document.getElementById('errorMessage');
            const successEl = document.getElementById('successMessage');
            const statusEl = document.getElementById('statusInfo');
            
            try {
                loadingEl.classList.remove('hidden');
                errorEl.classList.add('hidden');
                successEl.classList.add('hidden');
                statusEl.classList.add('hidden');

                // –ü–æ–ø—Ä–æ–±—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ URL –¥–ª—è Google Sheets
                const urls = [
                    `https://docs.google.com/spreadsheets/d/e/${GOOGLE_SHEETS_CONFIG.publishedId}/pub?gid=${GOOGLE_SHEETS_CONFIG.gid}&single=true&output=csv`,
                    `https://docs.google.com/spreadsheets/d/e/${GOOGLE_SHEETS_CONFIG.publishedId}/pub?output=csv`,
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º CORS –ø—Ä–æ–∫—Å–∏ –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
                    `https://api.allorigins.win/get?url=${encodeURIComponent(`https://docs.google.com/spreadsheets/d/e/${GOOGLE_SHEETS_CONFIG.publishedId}/pub?gid=${GOOGLE_SHEETS_CONFIG.gid}&single=true&output=csv`)}`
                ];
                
                let response = null;
                let csvText = '';
                let usedProxy = false;
                
                // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å —Ä–∞–∑–Ω—ã—Ö URL
                for (let i = 0; i < urls.length; i++) {
                    try {
                        console.log(`–ü–æ–ø—ã—Ç–∫–∞ ${i + 1}: –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å URL:`, urls[i]);
                        
                        if (i === 2) { // –ü–æ—Å–ª–µ–¥–Ω–∏–π URL - —ç—Ç–æ –ø—Ä–æ–∫—Å–∏
                            usedProxy = true;
                            response = await fetch(urls[i], {
                                method: 'GET',
                                cache: 'no-cache'
                            });
                            
                            if (response.ok) {
                                const proxyData = await response.json();
                                csvText = proxyData.contents;
                            }
                        } else {
                            response = await fetch(urls[i], {
                                method: 'GET',
                                mode: 'cors',
                                cache: 'no-cache'
                            });
                            
                            if (response.ok) {
                                csvText = await response.text();
                            }
                        }
                        
                        if (csvText && csvText.trim()) {
                            console.log(`–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —Å URL ${i + 1}${usedProxy ? ' (—á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏)' : ''}`);
                            break; // –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
                        }
                    } catch (fetchError) {
                        console.log(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å URL ${i + 1}:`, fetchError.message);
                        if (i === urls.length - 1) {
                            throw fetchError; // –ï—Å–ª–∏ –≤—Å–µ URL –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏, –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—à–∏–±–∫—É
                        }
                    }
                }
                
                if (!response || !response.ok) {
                    throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∏ —Å –æ–¥–Ω–æ–≥–æ URL. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ.`);
                }
                
                
                if (!csvText.trim()) {
                    throw new Error('–ü–æ–ª—É—á–µ–Ω –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ.');
                }

                console.log('–ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ CSV, –¥–ª–∏–Ω–∞:', csvText.length);
                console.log('–ü–µ—Ä–≤—ã–µ 200 —Å–∏–º–≤–æ–ª–æ–≤:', csvText.substring(0, 200));

                // –ü–∞—Ä—Å–∏–º CSV –¥–∞–Ω–Ω—ã–µ
                const rows = parseCSV(csvText);
                
                if (rows.length < 2) {
                    throw new Error('–í —Ç–∞–±–ª–∏—Ü–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ (–∫—Ä–æ–º–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤)');
                }

                console.log('–ù–∞–π–¥–µ–Ω–æ —Å—Ç—Ä–æ–∫:', rows.length);
                console.log('–ó–∞–≥–æ–ª–æ–≤–∫–∏:', rows[0]);

                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV –≤ –æ–±—ä–µ–∫—Ç –ø—Ä–æ—Ñ–∏–ª–µ–π
                profiles = {};
                let validProfiles = 0;
                
                // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É (–∑–∞–≥–æ–ª–æ–≤–∫–∏)
                rows.slice(1).forEach((row, index) => {
                    if (row.length >= 3 && row[0]?.trim()) { // –ú–∏–Ω–∏–º—É–º –∏–º—è, –±–∏–æ–≥—Ä–∞—Ñ–∏—è, —Ä–æ–ª—å
                        const id = index + 1;
                        profiles[id] = {
                            id: id,
                            name: row[0]?.trim() || '–ù–µ —É–∫–∞–∑–∞–Ω–æ',
                            bio: row[1]?.trim() || '–ë–∏–æ–≥—Ä–∞—Ñ–∏—è –Ω–µ —É–∫–∞–∑–∞–Ω–∞',
                            avatar: row[2]?.trim() || '',
                            favoriteWeapon: row[3]?.trim() || '–ù–µ —É–∫–∞–∑–∞–Ω–æ',
                            additionalWeapon: row[4]?.trim() || '–ù–µ —É–∫–∞–∑–∞–Ω–æ',
                            equipment: row[5] ? row[5].split(',').map(item => item.trim()).filter(item => item) : [],
                            role: row[6]?.trim() || '–û–ø–µ—Ä–∞—Ç–æ—Ä',
                            experience: row[7]?.trim() || '–ù–µ —É–∫–∞–∑–∞–Ω–æ',
                            score: parseInt(row[8]?.trim()) || Math.floor(Math.random() * 100) // –°–ª—É—á–∞–π–Ω—ã–µ –±–∞–ª–ª—ã –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã
                        };
                        validProfiles++;
                        console.log(`–ü—Ä–æ—Ñ–∏–ª—å ${id}:`, profiles[id]);
                    }
                });

                if (validProfiles === 0) {
                    throw new Error('–ù–µ –Ω–∞–π–¥–µ–Ω–æ –≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ.');
                }

                loadingEl.classList.add('hidden');
                successEl.innerHTML = `‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${validProfiles} –ø—Ä–æ—Ñ–∏–ª–µ–π –∏–∑ Google –¢–∞–±–ª–∏—Ü${usedProxy ? ' (—á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä)' : ''}`;
                successEl.classList.remove('hidden');
                
                displayParticipants();
                
                console.log('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', validProfiles, '–ø—Ä–æ—Ñ–∏–ª–µ–π');
                
                // –°–∫—Ä—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    successEl.classList.add('hidden');
                }, 3000);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                loadingEl.classList.add('hidden');
                
                if (error.name === 'TypeError' && error.message.includes('fetch')) {
                    errorEl.innerHTML = `
                        <strong>–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ (CORS):</strong> –ù–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Google –¢–∞–±–ª–∏—Ü–∞–º –Ω–∞–ø—Ä—è–º—É—é.<br><br>
                        <strong>–†–µ—à–µ–Ω–∏—è:</strong><br>
                        1. <strong>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:</strong> –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, GitHub Pages, Netlify)<br>
                        2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, Live Server –≤ VS Code)<br>
                        3. –û—Ç–∫—Ä–æ–π—Ç–µ Chrome —Å —Ñ–ª–∞–≥–æ–º: <code>--disable-web-security --user-data-dir=/tmp/chrome_dev</code><br><br>
                        <strong>–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:</strong> –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª —á–µ—Ä–µ–∑ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –≤–º–µ—Å—Ç–æ file:// –ø—Ä–æ—Ç–æ–∫–æ–ª–∞<br><br>
                        <em>–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏...</em>
                    `;
                } else {
                    errorEl.innerHTML = `
                        <strong>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:</strong> ${error.message}<br><br>
                        <strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:</strong><br>
                        1. –¢–∞–±–ª–∏—Ü–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞ –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞<br>
                        2. –í —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ (–º–∏–Ω–∏–º—É–º: –ò–º—è, –ë–∏–æ–≥—Ä–∞—Ñ–∏—è, –ê–≤–∞—Ç–∞—Ä)<br>
                        3. –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏<br>
                        4. –§–∞–π–ª –æ—Ç–∫—Ä—ã—Ç —á–µ—Ä–µ–∑ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä, –∞ –Ω–µ file:// –ø—Ä–æ—Ç–æ–∫–æ–ª<br><br>
                        <em>–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞...</em>
                    `;
                }
                
                errorEl.classList.remove('hidden');
                statusEl.innerHTML = `
                    <strong>‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ —Ç–∞–±–ª–∏—Ü–µ</strong><br>
                    –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å Google Sheets –Ω–µ–æ–±—Ö–æ–¥–∏–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä.<br>
                    <strong>–†–µ—à–µ–Ω–∏–µ:</strong> –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.
                `;
                statusEl.classList.remove('hidden');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
                loadDemoData();
            }
        }

        // –ü—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–µ—Ä CSV —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
        function parseCSV(text) {
            const rows = [];
            const lines = text.split('\n');
            
            for (let line of lines) {
                line = line.trim();
                if (line) {
                    // –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ CSV —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫–∞–≤—ã—á–µ–∫ –∏ –∑–∞–ø—è—Ç—ã—Ö –≤–Ω—É—Ç—Ä–∏ –ø–æ–ª–µ–π
                    const row = [];
                    let currentField = '';
                    let inQuotes = false;
                    
                    for (let i = 0; i < line.length; i++) {
                        const char = line[i];
                        
                        if (char === '"') {
                            if (inQuotes && line[i + 1] === '"') {
                                // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–∞–≤—ã—á–∫–∞
                                currentField += '"';
                                i++; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –∫–∞–≤—ã—á–∫—É
                            } else {
                                // –ù–∞—á–∞–ª–æ –∏–ª–∏ –∫–æ–Ω–µ—Ü –ø–æ–ª—è –≤ –∫–∞–≤—ã—á–∫–∞—Ö
                                inQuotes = !inQuotes;
                            }
                        } else if (char === ',' && !inQuotes) {
                            // –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –ø–æ–ª—è
                            row.push(currentField.trim());
                            currentField = '';
                        } else {
                            currentField += char;
                        }
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–ª–µ
                    row.push(currentField.trim());
                    
                    // –¢–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞–Ω–Ω—ã–º–∏
                    if (row.some(field => field.length > 0)) {
                        rows.push(row);
                    }
                }
            }
            
            return rows;
        }

        // –î–µ–º–æ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function loadDemoData() {
            profiles = {
                1: {
                    id: 1,
                    name: "–ê–ª–µ–∫—Å–µ–π –í–æ–ª–∫–æ–≤",
                    bio: "–û–ø—ã—Ç–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä —Å–ø–µ—Ü–Ω–∞–∑–∞ —Å 8-–ª–µ—Ç–Ω–∏–º —Å—Ç–∞–∂–µ–º. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ç–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –∏ –æ–±—É—á–µ–Ω–∏–∏ –Ω–æ–≤–æ–±—Ä–∞–Ω—Ü–µ–≤.",
                    avatar: "https://randomuser.me/api/portraits/men/1.jpg",
                    favoriteWeapon: "–ê–ö-74–ú",
                    additionalWeapon: "–ü–∏—Å—Ç–æ–ª–µ—Ç –ú–∞–∫–∞—Ä–æ–≤–∞",
                    equipment: [
                        "–ë—Ä–æ–Ω–µ–∂–∏–ª–µ—Ç 6–ë43",
                        "–®–ª–µ–º 6–ë47",
                        "–ù–æ—á–Ω—ã–µ –æ—á–∫–∏ –ù–í–î",
                        "–¢–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä—é–∫–∑–∞–∫",
                        "–°—Ä–µ–¥—Å—Ç–≤–∞ —Å–≤—è–∑–∏",
                        "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∞–ø—Ç–µ—á–∫–∞"
                    ],
                    role: "–û–ø–µ—Ä–∞—Ç–æ—Ä",
                    experience: "8 –ª–µ—Ç",
                    score: 85
                },
                2: {
                    id: 2,
                    name: "–°–µ—Ä–≥–µ–π –ü–µ—Ç—Ä–æ–≤",
                    bio: "–°–Ω–∞–π–ø–µ—Ä –≤—ã—Å–æ–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞, –º–∞—Å—Ç–µ—Ä –¥–∞–ª—å–Ω–µ–≥–æ –±–æ—è. –£—á–∞—Å—Ç–Ω–∏–∫ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π –ø–æ —Å—Ç—Ä–µ–ª—å–±–µ.",
                    avatar: "https://randomuser.me/api/portraits/men/2.jpg",
                    favoriteWeapon: "–°–í–î",
                    additionalWeapon: "–ê–ö–°-74–£",
                    equipment: [
                        "–û–ø—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏—Ü–µ–ª",
                        "–°–æ—à–∫–∏ –¥–ª—è –≤–∏–Ω—Ç–æ–≤–∫–∏",
                        "–ú–∞—Å–∫–∏—Ä–æ–≤–æ—á–Ω—ã–π –∫–æ—Å—Ç—é–º",
                        "–õ–∞–∑–µ—Ä–Ω—ã–π –¥–∞–ª—å–Ω–æ–º–µ—Ä",
                        "–ë–∞–ª–ª–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–º–ø—å—é—Ç–µ—Ä",
                        "–ó–∞—â–∏—Ç–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏"
                    ],
                    role: "–°–Ω–∞–π–ø–µ—Ä",
                    experience: "6 –ª–µ—Ç",
                    score: 92
                },
                3: {
                    id: 3,
                    name: "–ú–∞—Ä–∏—è –ö–æ–∑–ª–æ–≤–∞",
                    bio: "–ú–µ–¥–∏–∫ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è, —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ø–æ–ª–µ–≤–æ–π —Ö–∏—Ä—É—Ä–≥–∏–∏ –∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏.",
                    avatar: "https://randomuser.me/api/portraits/women/1.jpg",
                    favoriteWeapon: "–ê–ö–°-74–£",
                    additionalWeapon: "–ü–∏—Å—Ç–æ–ª–µ—Ç –ü–Ø",
                    equipment: [
                        "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Ä—é–∫–∑–∞–∫",
                        "–î–µ—Ñ–∏–±—Ä–∏–ª–ª—è—Ç–æ—Ä",
                        "–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–π –Ω–∞–±–æ—Ä",
                        "–û–±–µ–∑–±–æ–ª–∏–≤–∞—é—â–∏–µ",
                        "–ë–∏–Ω—Ç—ã –∏ –∂–≥—É—Ç—ã",
                        "–ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–∏"
                    ],
                    role: "–ú–µ–¥–∏–∫",
                    experience: "5 –ª–µ—Ç",
                    score: 78
                },
                4: {
                    id: 4,
                    name: "–î–º–∏—Ç—Ä–∏–π –°–º–∏—Ä–Ω–æ–≤",
                    bio: "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –≤–∑—Ä—ã–≤—á–∞—Ç—ã–º –≤–µ—â–µ—Å—Ç–≤–∞–º –∏ —Ä–∞–∑–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—é. –≠–∫—Å–ø–µ—Ä—Ç –≤ –æ–±–ª–∞—Å—Ç–∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–æ–µ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.",
                    avatar: "", // –ü—É—Å—Ç–∞—è —Å—Å—ã–ª–∫–∞ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    favoriteWeapon: "–ê–ö–°-74",
                    additionalWeapon: "–°–∏–≥–Ω–∞–ª—å–Ω—ã–π –ø–∏—Å—Ç–æ–ª–µ—Ç",
                    equipment: [
                        "–ù–∞–±–æ—Ä —Å–∞–ø–µ—Ä–∞",
                        "–î–µ—Ç–µ–∫—Ç–æ—Ä –º–µ—Ç–∞–ª–ª–∞",
                        "–í–∑—Ä—ã–≤—á–∞—Ç—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞",
                        "–°—Ä–µ–¥—Å—Ç–≤–∞ —Å–≤—è–∑–∏",
                        "–ó–∞—â–∏—Ç–Ω—ã–π –∫–æ—Å—Ç—é–º",
                        "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã"
                    ],
                    role: "–°–∞–ø–µ—Ä",
                    experience: "7 –ª–µ—Ç",
                    score: 89
                }
            };
            displayParticipants();
        }

        // –§—É–Ω–∫—Ü–∏–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        function sortBy(type) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            currentSort = type;
            displayParticipants();
        }

        function getSortedProfiles() {
            const profilesArray = Object.values(profiles);
            
            switch(currentSort) {
                case 'score':
                    return profilesArray.sort((a, b) => b.score - a.score);
                case 'name':
                    return profilesArray.sort((a, b) => a.name.localeCompare(b.name));
                default:
                    return profilesArray.sort((a, b) => a.id - b.id);
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function showParticipants() {
            document.getElementById('participantsSection').classList.remove('hidden');
            document.getElementById('profileSection').classList.add('hidden');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector('.nav-btn').classList.add('active');
        }

        function showProfile(userId) {
            document.getElementById('participantsSection').classList.add('hidden');
            document.getElementById('profileSection').classList.remove('hidden');
            loadProfile(userId);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
        function loadParticipants() {
            loadDataFromGoogleSheets();
        }

        function displayParticipants() {
            const container = document.getElementById('participantsContainer');
            
            if (Object.keys(profiles).length === 0) {
                container.innerHTML = '<div class="error">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>';
                return;
            }
            
            const sortedProfiles = getSortedProfiles();
            
            container.innerHTML = sortedProfiles.map(profile => `
                <div class="participant-card" onclick="showProfile(${profile.id})">
                    <div class="participant-header">
                        <div class="score-badge">${profile.score} üèÜ</div>
                        <img src="${getImageUrl(profile.avatar)}" alt="${profile.name}" class="participant-avatar" onerror="this.src='${getDefaultAvatar(profile.name)}'" loading="lazy" crossorigin="anonymous">
                        <div class="participant-name">${profile.name}</div>
                        <div class="participant-role">${profile.role}</div>
                    </div>
                    <div class="participant-info">
                        <div class="participant-bio">${profile.bio}</div>
                        <div class="participant-weapons">
                            <div class="weapon-info">
                                <span class="weapon-label">–û—Å–Ω–æ–≤–Ω–æ–µ –æ—Ä—É–∂–∏–µ:</span> ${profile.favoriteWeapon}
                            </div>
                            <div class="weapon-info">
                                <span class="weapon-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ:</span> ${profile.additionalWeapon}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è
        function loadProfile(userId) {
            const profile = profiles[userId];
            if (!profile) {
                document.getElementById('profileContainer').innerHTML = '<div class="error">–ü—Ä–æ—Ñ–∏–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω</div>';
                return;
            }

            const equipmentList = profile.equipment && profile.equipment.length > 0 
                ? profile.equipment.map(item => `<div class="equipment-item">${item}</div>`).join('')
                : '<div class="equipment-item">–°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ</div>';

            document.getElementById('profileContainer').innerHTML = `
                <div class="profile-header">
                    <div class="profile-score">${profile.score} üèÜ</div>
                    <img src="${getImageUrl(profile.avatar)}" alt="${profile.name}" class="profile-avatar" onerror="this.src='${getDefaultAvatar(profile.name, 150)}'" loading="lazy" crossorigin="anonymous">
                    <div class="profile-name">${profile.name}</div>
                    <div class="profile-bio">${profile.bio}</div>
                </div>
                <div class="profile-content">
                    <div class="profile-section">
                        <div class="section-title">üéñÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                        <div class="weapon-card">
                            <div class="weapon-title">–†–æ–ª—å:</div>
                            <div>${profile.role}</div>
                        </div>
                        <div class="weapon-card">
                            <div class="weapon-title">–û–ø—ã—Ç —Å–ª—É–∂–±—ã:</div>
                            <div>${profile.experience}</div>
                        </div>
                    </div>
                    
                    <div class="profile-section">
                        <div class="section-title">üî´ –í–æ–æ—Ä—É–∂–µ–Ω–∏–µ</div>
                        <div class="weapon-card">
                            <div class="weapon-title">–û—Å–Ω–æ–≤–Ω–æ–µ –æ—Ä—É–∂–∏–µ</div>
                            <div>${profile.favoriteWeapon}</div>
                        </div>
                        <div class="weapon-card">
                            <div class="weapon-title">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Ä—É–∂–∏–µ</div>
                            <div>${profile.additionalWeapon}</div>
                        </div>
                    </div>
                    
                    <div class="profile-section">
                        <div class="section-title">üéí –°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ</div>
                        <div class="equipment-card">
                            <div class="equipment-list">
                                ${equipmentList}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –∑–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö...');
            loadDataFromGoogleSheets();
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
        setInterval(() => {
            console.log('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...');
            loadDataFromGoogleSheets();
        }, 300000); // 5 –º–∏–Ω—É—Ç

    </script>
</body>
</html>